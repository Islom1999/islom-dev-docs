import{_ as n,o as a,c as s,d as t}from"./app-a9a991a6.js";const i={},o=t(`<h1 id="ðŸ“”-guards" tabindex="-1"><a class="header-anchor" href="#ðŸ“”-guards" aria-hidden="true">#</a> ðŸ“” Guards</h1><p>NestJS&#39;da &quot;Guards&quot; degan tushuncha ro&#39;yxatdan o&#39;tgan foydalanuvchini tekshirish uchun ishlatiladi. Ular asosan HTTP so&#39;rovi amalga oshirishdan oldin bajariladigan bir qadam sifatida xizmat qiladi. &quot;Guards&quot; bilan ishlashning yaxshi misoli ro&#39;yxatdan o&#39;tgan foydalanuvchini tekshiruvchi guard yaratish bo&#39;lishi mumkin.</p><p>Avvalambor, <code>AuthGuard</code> classini yaratamiz. Bu yerda &quot;passport&quot; paketi ishlatiladi, bu &quot;passport-jwt&quot; strategiyasi orqali ro&#39;yxatdan o&#39;tgan foydalanuvchini tekshirish uchun ishlatiladi:</p><div class="language-tsx line-numbers-mode" data-ext="tsx"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Injectable<span class="token punctuation">,</span> UnauthorizedException <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@nestjs/common&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AuthGuard <span class="token keyword">as</span> PassportAuthGuard <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@nestjs/passport&#39;</span><span class="token punctuation">;</span>

@<span class="token function">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">JwtAuthGuard</span> <span class="token keyword">extends</span> <span class="token class-name">PassportAuthGuard</span><span class="token punctuation">(</span><span class="token string">&#39;jwt&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">handleRequest</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> user<span class="token punctuation">,</span> info<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Buni boshqarish uchun qo&#39;shimcha shartlarni qo&#39;shishingiz mumkin</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err <span class="token operator">||</span> <span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> err <span class="token operator">||</span> <span class="token keyword">new</span> <span class="token class-name">UnauthorizedException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> user<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Endi, bu guardni kontrollerda ishlatishimiz mumkin. <code>@UseGuards()</code> decoratori orqali ishlatish mumkin. Bu decorator kontrollerga yoki kontrollerdagi biror metodga bir nechta guardlarni bir vaqtning o&#39;zida biriktirishga imkon beradi:</p><div class="language-tsx line-numbers-mode" data-ext="tsx"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Get<span class="token punctuation">,</span> UseGuards <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@nestjs/common&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> JwtAuthGuard <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./auth/jwt-auth.guard&#39;</span><span class="token punctuation">;</span>

@<span class="token function">Controller</span><span class="token punctuation">(</span><span class="token string">&#39;dashboard&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">DashboardController</span> <span class="token punctuation">{</span>
  @<span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  @<span class="token function">UseGuards</span><span class="token punctuation">(</span>JwtAuthGuard<span class="token punctuation">)</span>
  <span class="token function">getDashboard</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Ro&#39;yxatdan o&#39;tgan foydalanuvchi uchun ma&#39;lumotlarni qaytarish</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Bu yerda <code>getDashboard()</code> metodi faqatgina <code>JwtAuthGuard</code> guardi muvaffaqiyatli ishlaganida chaqiriladi. Agar guard muvaffaqiyatsiz ishlasa, <code>UnauthorizedException</code> tashlanadi va metod chaqirilmaydi.</p><p>Bu misol orqali, siz bir nechta guardlarni yaratib, ulardan birini yoki bir nechtasini har bir kontrollerga yoki metodga biriktirishingiz mumkin.</p>`,8),e=[o];function p(c,l){return a(),s("div",null,e)}const r=n(i,[["render",p],["__file","guard.html.vue"]]);export{r as default};
